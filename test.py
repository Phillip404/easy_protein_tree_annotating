# import pandas as pd
# import json
#
# dataframe = pd.read_csv('./test/info_index.tsv',sep='\t')
# pform = pd.DataFrame(columns=['seq_name','seq_id','alignment_start','alignment_end','envelope_start','envelope_end',\
# 'hmm_acc','hmm_name','hmm_desc','type','hmm_start','hmm_end','hmm_length','bit score','E-value','significance',\
# 'clan','predicted_active_site_residues'])
#
# for row in dataframe.iterrows():
#     data = row[1]['Domain Full Record [Pfamscan]']
#     data = '[%s]' % data
#     data = data.replace('\'','\"').replace('None','null')
#     dataframe.at[row[0],'Domain Full Record [Pfamscan]'] = data
#     data = json.loads(data)
#
#
#     seq_name = row[1]['Name']
#     seq_id = row[1]['ID']
#
#     for domain in data:
#         domain = dict(domain)
#         print(domain)
#
#         ranID = dict(domain['seq'])['name']
#
#         record = pd.DataFrame([[seq_name,seq_id]], columns=['seq_name', 'seq_id'], index=[ranID])
#
#         record['alignment_start'] = dict(domain['seq'])['from']
#         record['alignment_end'] = dict(domain['seq'])['to']
#         record['envelope_start']= dict(domain['env'])['from']
#         record['envelope_end'] = dict(domain['env'])['to']
#         record['hmm_acc'] = domain['acc']
#         record['hmm_name'] = domain['name']
#         record['hmm_desc'] = domain['desc']
#         record['type'] = domain['type']
#         record['hmm_start'] = dict(domain['hmm'])['from']
#         record['hmm_end'] = dict(domain['hmm'])['to']
#         record['hmm_length'] = domain['model_length']
#         record['bit score'] = domain['bits']
#         record['E-value'] = domain['evalue']
#         record['significance'] = domain['sig']
#         record['clan'] = domain['clan']
#         record['predicted_active_site_residues'] = domain['act_site']
#         # print(record)
#
#         pform = pform.append(record)
#
# # print(pform)
# pform.to_csv(args.outfile + '\\00_Parsed_Fasta\pfamscan_details.tsv',sep='\t')
#
# # data = """[{"model_length": "243", "align": ["#HMM       ilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag.rdvDavlTtrElaellkeagidlakleeeeldnplgessgagki...................................egvkeaevele.....gktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg", "#MATCH     ++galiK+y+a+k     ++i++ s+mPCtaKk+E+ar +++++g  d+Dav+TtrEl++l+++ +i +++l+e+++d plg+ +ga+ i                                   +g+kea ve++     +ktl++av++G+k ++kll+ ++age++y+f+EvmaCpgGCigGg", "#PP        89***************************************99889*******************************************************************************99999997765445546678****************************************8", "#SEQ       MMGALIKSYYAKKlgvapSQIFSCSVMPCTAKKQEIARAQLSTDGvADIDAVITTRELGKLVRKHHIVFNQLPESKFDCPLGSGTGAAIIfgatggvmeaalrtayelasgtplpvlnyapvrgfDGIKEAMVEVPlptgeKKTLRIAVASGIKYAQKLLDGIRAGEKEYHFVEVMACPGGCIGGG"], "env": {"to": "186", "from": "1"}, "name": "Fe_hyd_lg_C", "acc": "PF02906.14", "sig": 1, "evalue": "1.3e-42", "desc": "Iron only hydrogenase large subunit, C-terminal domain", "hmm": {"to": "243", "from": "104"}, "act_site": None, "type": "Domain", "bits": "146.1", "clan": "No_clan", "seq": {"to": "186", "from": "1", "name": "i6j8l50wKOrP7Xpz"}},{"model_length": "56", "align": ["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtdr", "#MATCH     ++++kR++a+y+iD++++lr+SheNp++ +lYkefl++pls+k+helLHThY dr", "#PP        589**************************************************98", "#SEQ       NILQKRTEAIYNIDERSTLRRSHENPDIAQLYKEFLEKPLSHKSHELLHTHYSDR"], "env": {"to": "249", "from": "194"}, "name": "Fe_hyd_SSU", "acc": "PF02256.17", "sig": 1, "evalue": "4.3e-26", "desc": "Iron hydrogenase small subunit", "hmm": {"to": "56", "from": "2"}, "act_site": None, "type": "Domain", "bits": "90.7", "clan": "No_clan", "seq": {"to": "249", "from": "195", "name": "i6j8l50wKOrP7Xpz"}},{"model_length": "143", "align": ["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydes.lseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW", "#MATCH     i+Y+++tGn++++Ak++a e+++++++  +v+l+ +++  ++ + +  ll+ vtsTfg+G+ p+n++ +f+++le   +   +  +++ r+ vfg G+s+y+ Fc+a+ ++d+++++lGa+ l++l+ gde + e++e a+  W", "#PP        89********************99875.566677777667999999*********************.********976..5568***********************************************999888887666", "#SEQ       IVYATQTGNSKEIAKRIASEAKNKDVE-FAVTLKPIEKInPETLIKSGLLVYVTSTFGMGEHPDNAA-NFWEWLESSDH--AENLFENTRVGVFGIGSSSYPMFCQAAIEVDDRMKALGAKSLVPLGMGDELHPEKYEGALGPW"], "env": {"to": "415", "from": "276"}, "name": "Flavodoxin_1", "acc": "PF00258.25", "sig": 1, "evalue": "2.5e-31", "desc": "Flavodoxin", "hmm": {"to": "143", "from": "1"}, "act_site": None, "type": "Domain", "bits": "108.8", "clan": "CL0042", "seq": {"to": "415", "from": "276", "name": "i6j8l50wKOrP7Xpz"}},{"model_length": "222", "align": ["#HMM       lakvlknreLtkpesernvihveldisdsglkYetGdhlgvypsNneelVeellellgldpkadevvelkaldeesaekeprleptTlrqalkyylditgppskqlleaLaefaseeeekqkLekLssdegakeykelklneartllevleefpsvklplefLlevlpqLkpRyYSiSssskvhpdevhltvvVveyetdgegrirkGvcsny", "#MATCH      +++++++++t+ +  r    + ++++++ l+YetG h+++ ++ + + V+ l ++l +dp  + v+ ++  ++ + + + +    T+r+++  yld++gp +k +l++L++f ++ +e+++L  L  +eg++e+ e  + e+  + ev++ f+sv ++l+ L+e++p  +pR YSi+ss  +hp++++l++ +v+++t ++g +r+G+c+ y", "#PP        5788899999999999***9*****************************************..99****99994.688999999******************************************************************************************************************8.***********98", "#SEQ       YVRLSHSEKITPNGVPRDAYKFHFELENTTLTYETGFHISILARAPTDVVDTLCKRLSIDP--EMVITVRGNGD-TEVPPGLSRSLTVREVFGLYLDVCGPITKSFLKSLIPFTTDRSERERLLHLTAKEGKDEFAEQFVAESVRYHEVFDMFKSVSVSLDYLIEMIPGNNPRLYSIASSHMMHPEQIQLVIGIVDWKT-AKGTMRYGQCTRY"], "env": {"to": "666", "from": "452"}, "name": "FAD_binding_1", "acc": "PF00667.20", "sig": 1, "evalue": "3.9e-42", "desc": "FAD binding domain", "hmm": {"to": "222", "from": "10"}, "act_site": None, "type": "Domain", "bits": "144.3", "clan": "CL0076", "seq": {"to": "666", "from": "458", "name": "i6j8l50wKOrP7Xpz"}},{"model_length": "109", "align": ["#HMM       agGtGiaPvrsvlraileeak...dktkvvlvyGnrtee.dllyreeleelakklpgrlkvvavvsreeagweggkgrvqdalleells....lkkeethvyvCGp", "#MATCH     + G+GiaP+rs+++++ +  +    ++k+++++G+r+++ d l+ +e+e++  ++ g + +v++ sre+a++    ++v+++++e+ +     l   + ++  CGp", "#PP        66**************9985569999*********99988***********..555669999999*999997....777777777655544445555556666666", "#SEQ       GLGSGIAPFRSFMQHREALYNrgiMQGKCTIYFGCRRRNeDALCIDEFEKW--EKMGLCDYVTAFSREQAKK----VYVTHRMRENPERvwnsLGAVDGFFGYCGP"], "env": {"to": "802", "from": "699"}, "name": "NAD_binding_1", "acc": "PF00175.21", "sig": 1, "evalue": "2.2e-10", "desc": "Oxidoreductase NAD-binding domain ", "hmm": {"to": "100", "from": "3"}, "act_site": None, "type": "Domain", "bits": "41.1", "clan": "CL0091", "seq": {"to": "800", "from": "701", "name": "i6j8l50wKOrP7Xpz"}}]"""
# #
# #
# #
# # data2 = '''[{"model_length":"243","align":["#HMM       ilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag.rdvDavlTtrElaellkeagidlakleeeeldnplgessgagki...................................egvkeaevele.....gktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH     ++galiK+y+a+k     ++i++ s+mPCtaKk+E+ar +++++g  d+Dav+TtrEl++l+++ +i +++l+e+++d plg+ +ga+ i                                   +g+kea ve++     +ktl++av++G+k ++kll+ ++age++y+f+EvmaCpgGCigGg","#PP        89***************************************99889*******************************************************************************99999997765445546678****************************************8","#SEQ       MMGALIKSYYAKKlgvapSQIFSCSVMPCTAKKQEIARAQLSTDGvADIDAVITTRELGKLVRKHHIVFNQLPESKFDCPLGSGTGAAIIfgatggvmeaalrtayelasgtplpvlnyapvrgfDGIKEAMVEVPlptgeKKTLRIAVASGIKYAQKLLDGIRAGEKEYHFVEVMACPGGCIGGG"],"env":{"to":"186","from":"1"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"1.3e-42","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"104"},"act_site":null,"type":"Domain","bits":"146.1","clan":"No_clan","seq":{"to":"186","from":"1","name":"GIQ79514.1"}},{"model_length":"56","align":["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtdr","#MATCH     ++++kR++a+y+iD++++lr+SheNp++ +lYkefl++pls+k+helLHThY dr","#PP        589**************************************************98","#SEQ       NILQKRTEAIYNIDERSTLRRSHENPDIAQLYKEFLEKPLSHKSHELLHTHYSDR"],"env":{"to":"249","from":"194"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"4.3e-26","desc":"Iron hydrogenase small subunit","hmm":{"to":"56","from":"2"},"act_site":null,"type":"Domain","bits":"90.7","clan":"No_clan","seq":{"to":"249","from":"195","name":"GIQ79514.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydes.lseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     i+Y+++tGn++++Ak++a e+++++++  +v+l+ +++  ++ + +  ll+ vtsTfg+G+ p+n++ +f+++le   +   +  +++ r+ vfg G+s+y+ Fc+a+ ++d+++++lGa+ l++l+ gde + e++e a+  W","#PP        89********************99875.566677777667999999*********************.********976..5568***********************************************999888887666","#SEQ       IVYATQTGNSKEIAKRIASEAKNKDVE-FAVTLKPIEKInPETLIKSGLLVYVTSTFGMGEHPDNAA-NFWEWLESSDH--AENLFENTRVGVFGIGSSSYPMFCQAAIEVDDRMKALGAKSLVPLGMGDELHPEKYEGALGPW"],"env":{"to":"415","from":"276"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"2.5e-31","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"108.8","clan":"CL0042","seq":{"to":"415","from":"276","name":"GIQ79514.1"}},{"model_length":"222","align":["#HMM       lakvlknreLtkpesernvihveldisdsglkYetGdhlgvypsNneelVeellellgldpkadevvelkaldeesaekeprleptTlrqalkyylditgppskqlleaLaefaseeeekqkLekLssdegakeykelklneartllevleefpsvklplefLlevlpqLkpRyYSiSssskvhpdevhltvvVveyetdgegrirkGvcsny","#MATCH      +++++++++t+ +  r    + ++++++ l+YetG h+++ ++ + + V+ l ++l +dp  + v+ ++  ++ + + + +    T+r+++  yld++gp +k +l++L++f ++ +e+++L  L  +eg++e+ e  + e+  + ev++ f+sv ++l+ L+e++p  +pR YSi+ss  +hp++++l++ +v+++t ++g +r+G+c+ y","#PP        5788899999999999***9*****************************************..99****99994.688999999******************************************************************************************************************8.***********98","#SEQ       YVRLSHSEKITPNGVPRDAYKFHFELENTTLTYETGFHISILARAPTDVVDTLCKRLSIDP--EMVITVRGNGD-TEVPPGLSRSLTVREVFGLYLDVCGPITKSFLKSLIPFTTDRSERERLLHLTAKEGKDEFAEQFVAESVRYHEVFDMFKSVSVSLDYLIEMIPGNNPRLYSIASSHMMHPEQIQLVIGIVDWKT-AKGTMRYGQCTRY"],"env":{"to":"666","from":"452"},"name":"FAD_binding_1","acc":"PF00667.20","sig":1,"evalue":"3.9e-42","desc":"FAD binding domain","hmm":{"to":"222","from":"10"},"act_site":null,"type":"Domain","bits":"144.3","clan":"CL0076","seq":{"to":"666","from":"458","name":"GIQ79514.1"}},{"model_length":"109","align":["#HMM       agGtGiaPvrsvlraileeak...dktkvvlvyGnrtee.dllyreeleelakklpgrlkvvavvsreeagweggkgrvqdalleells....lkkeethvyvCGp","#MATCH     + G+GiaP+rs+++++ +  +    ++k+++++G+r+++ d l+ +e+e++  ++ g + +v++ sre+a++    ++v+++++e+ +     l   + ++  CGp","#PP        66**************9985569999*********99988***********..555669999999*999997....777777777655544445555556666666","#SEQ       GLGSGIAPFRSFMQHREALYNrgiMQGKCTIYFGCRRRNeDALCIDEFEKW--EKMGLCDYVTAFSREQAKK----VYVTHRMRENPERvwnsLGAVDGFFGYCGP"],"env":{"to":"802","from":"699"},"name":"NAD_binding_1","acc":"PF00175.21","sig":1,"evalue":"2.2e-10","desc":"Oxidoreductase NAD-binding domain ","hmm":{"to":"100","from":"3"},"act_site":null,"type":"Domain","bits":"41.1","clan":"CL0091","seq":{"to":"800","from":"701","name":"GIQ79514.1"}},{"model_length":"82","align":["#HMM       pvtltfDGkevtvpeGdtvasAllangvdvprsckygrprgelcaggeCrnClVeve..gepnvracstpvedGlkvetqt","#MATCH      vtl+++G+e++vpeG tv++A++ +g+++p  c++      l++ g+Cr C+Ve+   + p + +c+t+v++G+ + t++","#PP        59**********************************....789*************83357889*************9986","#SEQ       LVTLKINGNEYKVPEGMTVLEACQSQGINIPFVCHH----PRLKPLGKCRVCVVEIRgdEFPIQTSCTTKVAEGMDIWTNS"],"env":{"to":"108","from":"29"},"name":"Fer2_4","acc":"PF13510.6","sig":1,"evalue":"9e-18","desc":"2Fe-2S iron-sulfur cluster binding domain","hmm":{"to":"81","from":"3"},"act_site":null,"type":"Domain","bits":"64.1","clan":"CL0486","seq":{"to":"107","from":"31","name":"XP_012899174.1"}},{"model_length":"243","align":["#HMM       kvvvqvAPavrvalgeefglsv.aattgklvaalrklGfdkVfdtafgadltimeeasellerleeeeklpmitScCPgwvkyvekkypellpnlssvkSPqqilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag..rdvDavlTtrElaellkeagi.dlakleeeeldnplgessgagki...................................egvkeaevelegktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH      +v q+APa+rva+ge+fg ++ ++ttgk+va+ + lGf++Vfdt+fgad+timee++eller++++ + pm+tScCPgwv+++ek ypel+pnlss++SP+++lg+++K+y+a+k     e+i+ Vs+mPCtaKk E++r+++  ++    vDavlTt+El++  k++++ d+++  e ++d+p+g  +gag i                                   +g+k+ +v+++g+++++avv+  k +++l+e++kag+ + +f+EvmaCpgGCi Gg","#PP        6899**************************************************************99****************************************************************************985567*****************9986378****************************************************************************97.789*****************************8","#SEQ       VMVLQTAPATRVAFGENFGREPgEVTTGKMVACAKALGFQYVFDTNFGADMTIMEEGTELLERIKNKGPFPMFTSCCPGWVNMAEKCYPELIPNLSSCRSPHMMLGSCVKTYWAKKmnlkpEDIYLVSLMPCTAKKDEIERRQMWLNEttPTVDAVLTTKELGDFCKQENLtDWDSFAEMDFDSPMGICTGAGDIfgvsggvmeaalrtayelqtgkplekitvdearglDGTKRFSVDMNGTKVNCAVVHS-KYARELMENIKAGKEDLQFVEVMACPGGCISGG"],"env":{"to":"517","from":"232"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"2.9e-86","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"2"},"act_site":null,"type":"Domain","bits":"289.1","clan":"No_clan","seq":{"to":"517","from":"233","name":"XP_012899174.1"}},{"model_length":"56","align":["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtd","#MATCH     d++ kR++a+y+iD+ kklrkSheNp+++ +Ykef+++p+s+ ahelLHT+Y +","#PP        7899************************************************75","#SEQ       DTMDKRMNAIYSIDAGKKLRKSHENPDIQTIYKEFFEKPGSHVAHELLHTTYAA"],"env":{"to":"580","from":"525"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"4.3e-25","desc":"Iron hydrogenase small subunit","hmm":{"to":"55","from":"2"},"act_site":null,"type":"Domain","bits":"87.6","clan":"No_clan","seq":{"to":"579","from":"526","name":"XP_012899174.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydeslseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     i+YgS+tG+t k Akql+ +++e+g+ + v+ ++++d  +++++e++ +++ t T+g G++p+ +   f++ l  +  +l+d+ l++v+f vfglG++a + Fc+ +++lde++eelGaerl+  +eg+e++ + +++af+ W","#PP        89***********************************..68*********************7766.666666666..578888***********************************************99********99","#SEQ       IIYGSQTGTTAKAAKQLQAKFKEAGIASAVIPMNKFD--VEQLPEKKKVVLMTCTYGSGEFPDMAT-DFWEALSSE--DLDDDFLEDVKFGVFGLGSKAFKMFCECAHQLDERMEELGAERLVDCGEGNEKDPQQYKTAFEPW"],"env":{"to":"748","from":"611"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"8.6e-33","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"113.6","clan":"CL0042","seq":{"to":"748","from":"611","name":"XP_012899174.1"}},{"model_length":"82","align":["#HMM       pvtltfDGkevtvpeGdtvasAllangvdvprsckygrprgelcaggeCrnClVeveg..epnvracstpvedGlkvetqt","#MATCH      v+++++G+e++vpeG tv++A++a+g++vp  c++      l++ g+Cr C+Ve+ g   p   +c t+ve+G+ + t++","#PP        6899********************************....789*************86215556*************9986","#SEQ       LVSVKINGNEYKVPEGMTVLEACQAQGIHVPFVCHH----PRLKPLGKCRVCVVEIRGdeFPIKTSCNTKVEEGMDIWTNS"],"env":{"to":"108","from":"29"},"name":"Fer2_4","acc":"PF13510.6","sig":1,"evalue":"1.4e-17","desc":"2Fe-2S iron-sulfur cluster binding domain","hmm":{"to":"81","from":"3"},"act_site":null,"type":"Domain","bits":"63.5","clan":"CL0486","seq":{"to":"107","from":"31","name":"OAO11745.1"}},{"model_length":"52","align":["#HMM       rCigCgaCvaaCp....vkaieldeeenekgt.....ekveidpekClgCgaCvavCPtga","#MATCH     rC+ C++C++aC+    ++++e +++  e g+      +  ++ ++C++Cg+C  vCPtga","#PP        8***********87544555555543..333433322333667899*************98","#SEQ       RCVDCKRCARACSelqgMNVLENNPQ--EGGFpvvptGYHLLKDTECISCGQCNVVCPTGA"],"env":{"to":"214","from":"156"},"name":"Fer4_7","acc":"PF12838.7","sig":1,"evalue":"3.2e-06","desc":"4Fe-4S dicluster domain","hmm":{"to":"52","from":"1"},"act_site":null,"type":"Domain","bits":"27.6","clan":"CL0344","seq":{"to":"214","from":"156","name":"OAO11745.1"}},{"model_length":"243","align":["#HMM       kvvvqvAPavrvalgeefglsv.aattgklvaalrklGfdkVfdtafgadltimeeasellerleeeeklpmitScCPgwvkyvekkypellpnlssvkSPqqilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag..rdvDavlTtrElaellkeagidl.akleeeeldnplgessgagki...................................egvkeaevelegktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH      +v+q+APa+rva+ge+fg ++ + ttgk++a+ + lGf++Vfdt+fgad+timee++eller++++ + pm+tScCPgwv+++ek ype+lpnlss++SP++++g+ +K+y+a+k     e+i+vVs+mPCtaKk E++r+++  ++    vDavlTt+El++  k++gi+  +++ e ++d+plg+ssgag i                                   +g+k+ +v+++gk++++avv+  k +++l+e++kag+ + +f+EvmaCpgGCi Gg","#PP        689***************************************************************99****************************************************************************9855579*******************9655****************************************************************************96.889*****************************8","#SEQ       VMVMQTAPATRVAFGENFGREPgEITTGKMIACAKALGFQYVFDTNFGADMTIMEEGTELLERIKNNGPFPMFTSCCPGWVNMAEKCYPEILPNLSSCRSPHMMVGSTLKTYWAKKmnlkpEDIYVVSLMPCTAKKDEIERKNMWLDEktPFVDAVLTTKELGDFCKQEGITNwDNMAEMPFDTPLGTSSGAGDIfgvsggvmeaalrtayqlqtgkplekivvdearglDGTKRFSVDMNGKKINCAVVHS-KFARELVENVKAGKEDLQFVEVMACPGGCISGG"],"env":{"to":"517","from":"232"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"7.5e-87","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"2"},"act_site":null,"type":"Domain","bits":"291.0","clan":"No_clan","seq":{"to":"517","from":"233","name":"OAO11745.1"}},{"model_length":"56","align":["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtd","#MATCH     d+++kR++a+ykiD+ k+lr+S +Npe++ lYkef+++p+s+kahelLHT+Y +","#PP        789*************************************************76","#SEQ       DTIEKRMNAIYKIDAGKTLRRSMDNPEIQTLYKEFFEKPNSHKAHELLHTTYAP"],"env":{"to":"580","from":"525"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"6.2e-24","desc":"Iron hydrogenase small subunit","hmm":{"to":"55","from":"2"},"act_site":null,"type":"Domain","bits":"83.8","clan":"No_clan","seq":{"to":"579","from":"526","name":"OAO11745.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydeslseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     ilYgSetG+t k Ak+l+ +++++g+++ v+ ++++d  +++++e++ l++ t T+g G++p  ++ +f++ l +++  l+d+ l+gv+f vfglG++a ++Fc+a+++lde++eelGaer++  +eg+e++ + +++af+ W","#PP        89***********************************..68*********************7777.8888888885..67777***********************************************99********99","#SEQ       ILYGSETGTTAKAAKALQSKFKAAGISSAVIPMNKID--VESLPEKKKLVLMTCTYGAGEFPAMAQ-EFWENLSDES--LDDDFLEGVEFGVFGLGSKAFKQFCEAAHQLDERMEELGAERVVDCGEGNEKDPQQYKTAFEPW"],"env":{"to":"749","from":"612"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"1.5e-33","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"116.0","clan":"CL0042","seq":{"to":"749","from":"612","name":"OAO11745.1"}},{"model_length":"82","align":["#HMM       pvtltfDGkevtvpeGdtvasAllangvdvprsckygrprgelcaggeCrnClVeveg..epnvracstpvedGlkvetqt","#MATCH      v+++++G+e++vpeG tv++A++a+g++vp  c++      l++ g+Cr C+Ve+ g   p   +c t+ve+G+ + t++","#PP        6899********************************....789*************86215556*************9986","#SEQ       LVSVKINGNEYKVPEGMTVLEACQAQGIHVPFVCHH----PRLKPLGKCRVCVVEIRGdeFPIKTSCNTKVEEGMDIWTNS"],"env":{"to":"108","from":"29"},"name":"Fer2_4","acc":"PF13510.6","sig":1,"evalue":"1.4e-17","desc":"2Fe-2S iron-sulfur cluster binding domain","hmm":{"to":"81","from":"3"},"act_site":null,"type":"Domain","bits":"63.5","clan":"CL0486","seq":{"to":"107","from":"31","name":"ACD10930.1"}},{"model_length":"52","align":["#HMM       rCigCgaCvaaCp....vkaieldeeenekgt.....ekveidpekClgCgaCvavCPtga","#MATCH     rC+ C++C++aC+    ++++e +++  e g+      +  ++ ++C++Cg+C  vCPtga","#PP        8***********87544555555543..333433322333667899*************98","#SEQ       RCVDCKRCARACSelqgMNVLENNPQ--EGGFpvvptGYHLLKDTECISCGQCNVVCPTGA"],"env":{"to":"214","from":"156"},"name":"Fer4_7","acc":"PF12838.7","sig":1,"evalue":"3.2e-06","desc":"4Fe-4S dicluster domain","hmm":{"to":"52","from":"1"},"act_site":null,"type":"Domain","bits":"27.6","clan":"CL0344","seq":{"to":"214","from":"156","name":"ACD10930.1"}},{"model_length":"243","align":["#HMM       kvvvqvAPavrvalgeefglsv.aattgklvaalrklGfdkVfdtafgadltimeeasellerleeeeklpmitScCPgwvkyvekkypellpnlssvkSPqqilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag..rdvDavlTtrElaellkeagidl.akleeeeldnplgessgagki...................................egvkeaevelegktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH      +v+q+APa+rva+ge+fg ++ + ttgk++a+ + lGf++Vfdt+fgad+timee++eller++++ + pm+tScCPgwv+++ek ype+lpnlss++SP++++g+ +K+y+a+k     e+i+vVs+mPCtaKk E++r+++  ++    vDavlTt+El++  k++gi+  +++ e ++d+plg+ssgag i                                   +g+k+ +v+++gk++++avv+  k +++l+e++kag+ + +f+E maCpgGCi Gg","#PP        689***************************************************************99****************************************************************************9855579*******************9655****************************************************************************96.889*****************************8","#SEQ       VMVMQTAPATRVAFGENFGREPgEITTGKMIACAKALGFQYVFDTNFGADMTIMEEGTELLERIKNNGPFPMFTSCCPGWVNMAEKCYPEILPNLSSCRSPHMMVGSTLKTYWAKKmnlkpEDIYVVSLMPCTAKKDEIERKNMWLDEktPFVDAVLTTKELGDFCKQEGITNwDNMAEMPFDTPLGTSSGAGDIfgvsggvmeaalrtayqlqtgkplekivvdearglDGTKRFSVDMNGKKINCAVVHS-KFARELVENVKAGKEDLQFVEAMACPGGCISGG"],"env":{"to":"517","from":"232"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"3.2e-86","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"2"},"act_site":null,"type":"Domain","bits":"288.9","clan":"No_clan","seq":{"to":"517","from":"233","name":"ACD10930.1"}},{"model_length":"56","align":["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtd","#MATCH     d+++kR++a+ykiD+ k+lr+S +Npe++ lYkef+++p+s+kahelLHT+Y +","#PP        789*************************************************76","#SEQ       DTIEKRMNAIYKIDAGKTLRRSMDNPEIQTLYKEFFEKPNSHKAHELLHTTYAP"],"env":{"to":"580","from":"525"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"6.2e-24","desc":"Iron hydrogenase small subunit","hmm":{"to":"55","from":"2"},"act_site":null,"type":"Domain","bits":"83.8","clan":"No_clan","seq":{"to":"579","from":"526","name":"ACD10930.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydeslseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     ilYgSetG+t k Ak+l+ +++++g+++ v+ ++++d  +++++e++ l++ t T+g G++p  ++ +f++ l +++  l+d+ l+gv+f vfglG++a ++Fc+a+++lde++eelGaer++  +eg+e++ + +++af+ W","#PP        89***********************************..68*********************7777.8888888885..67777***********************************************99********99","#SEQ       ILYGSETGTTAKAAKALQSKFKAAGISSAVIPMNKID--VESLPEKKKLVLMTCTYGAGEFPAMAQ-EFWENLSDES--LDDDFLEGVEFGVFGLGSKAFKQFCEAAHQLDERMEELGAERVVDCGEGNEKDPQQYKTAFEPW"],"env":{"to":"749","from":"612"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"1.5e-33","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"116.0","clan":"CL0042","seq":{"to":"749","from":"612","name":"ACD10930.1"}},{"model_length":"82","align":["#HMM       vtltfDGkevtvpeGdtvasAllangvdvprsckygrprgelcaggeCrnClVeve..gepnvracstpvedGlkvetqt","#MATCH     ++++++G+e++vpeG tv++A++a+g+ vp  c++      l + g+Cr C+Ve+   + p + +c+t+v++G+ + t++","#PP        789********************************....789*************83346779*************9986","#SEQ       LSIKINGTEYKVPEGMTVLEACQAQGIPVPFVCHH----PRLAPLGKCRVCVVEIRgeEFPIQTSCTTRVAEGMDIWTNS"],"env":{"to":"108","from":"29"},"name":"Fer2_4","acc":"PF13510.6","sig":1,"evalue":"2.5e-17","desc":"2Fe-2S iron-sulfur cluster binding domain","hmm":{"to":"81","from":"4"},"act_site":null,"type":"Domain","bits":"62.7","clan":"CL0486","seq":{"to":"107","from":"32","name":"XP_014527296.1"}},{"model_length":"243","align":["#HMM       kvvvqvAPavrvalgeefglsv.aattgklvaalrklGfdkVfdtafgadltimeeasellerleeeeklpmitScCPgwvkyvekkypellpnlssvkSPqqilgaliKkylaek.....ekivvVsimPCtaKklEaareefksag..rdvDavlTtrElaellkeagi.dlakleeeeldnplgessgagki...................................egvkeaevelegktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH      +v q APa+rva++e++g ++ + +tgk+va+ +  Gf++Vfdt+fgadltimee++eller++++ + pm+tScCPgw++++ek ypel+pnlss++SP++++ga +K+y+a+k     e+i+ Vs+mPCtaKk E++r+++  ++    vDavlTt+El++  k++gi ++a+  e ++d+p+g  sgag i                                   +g+k+ +v+++g+++++avv+  k  ++l+e++kag+ + +f+EvmaCpgGCi Gg","#PP        6899**************************************************************99****************************************************************************996669********************8578****************************************************************************97.67899***************************8","#SEQ       VMVLQAAPATRVAFAENYGREPgEISTGKMVACAKAAGFQYVFDTNFGADLTIMEEGTELLERIKNKGPFPMFTSCCPGWINMAEKCYPELIPNLSSCRSPHMMVGATVKTYWAKKmnlkpEDIYLVSLMPCTAKKDEIERKQMWLNEkvPTVDAVLTTKELGDFCKQKGIlNWADFAEMDFDSPMGICSGAGDIfgasggvmeaalrtayelqtgkplekldvtearglDGIKRFSVDMNGTKVNCAVVHS-KYSRELMENIKAGKEDLQFVEVMACPGGCISGG"],"env":{"to":"522","from":"237"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"5.8e-85","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"2"},"act_site":null,"type":"Domain","bits":"284.8","clan":"No_clan","seq":{"to":"522","from":"238","name":"XP_014527296.1"}},{"model_length":"56","align":["#HMM       dvrkkRakalykiDkkkklrkSheNpevkklYkeflgeplsekahelLHThYtd","#MATCH     d+++kR++a+y+iD+ kk+rkSheNp++ klY ef+++p+s++ahelLHT+Y +","#PP        789*************************************************75","#SEQ       DTIQKRMDAIYRIDAGKKMRKSHENPDIVKLYSEFFEKPGSHLAHELLHTTYAA"],"env":{"to":"585","from":"530"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"1.4e-24","desc":"Iron hydrogenase small subunit","hmm":{"to":"55","from":"2"},"act_site":null,"type":"Domain","bits":"85.9","clan":"No_clan","seq":{"to":"584","from":"531","name":"XP_014527296.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydeslseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     ilYg+etG+t k Ak+la +++e+g+ ++v+ +++++  ++++++ ++l++ t T+g G++p n++ +f++ l +++  l+d+ l++ +favfglG+++ ++Fc+a+++lde++eelGaer+++ +eg+e++ + +++ f+ W","#PP        89***********************************..57***********************99.7777777764..67778***********************************************999999999999","#SEQ       ILYGTETGTTAKAAKSLAGKFKEAGIASQVIPMDKVE--VDSLPDMKNLVLMTCTYGAGEFPSNAQ-EFWEALSDDS--LDDDFLEDHKFAVFGLGSKNFKQFCEAAHQLDERMEELGAERVVECGEGNEKDPQQYKTNFEPW"],"env":{"to":"752","from":"615"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"1.5e-33","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"116.1","clan":"CL0042","seq":{"to":"752","from":"615","name":"XP_014527296.1"}},{"model_length":"82","align":["#HMM       vtltfDGkevtvpeGdtvasAllangvdvprsckygrprgelcaggeCrnClVevegepnvracstpvedGlkvetqt","#MATCH     ++++++G +++vp+++ v++A++++ v++p++c++      l + g+C  C+V+++g +   +cst+v++G+ +et+ ","#PP        899********************************....89**********************************985","#SEQ       ISVKVNGVPIEVPKNTWVIDACAKAEVYIPTLCHH----PDLPPAGKCGICVVKINGSQYSLSCSTKVTQGMIIETDA"],"env":{"to":"76","from":"1"},"name":"Fer2_4","acc":"PF13510.6","sig":1,"evalue":"3.8e-14","desc":"2Fe-2S iron-sulfur cluster binding domain","hmm":{"to":"81","from":"4"},"act_site":null,"type":"Domain","bits":"52.5","clan":"CL0486","seq":{"to":"75","from":"2","name":"OHT04390.1"}},{"model_length":"243","align":["#HMM       kvvvqvAPavrvalgeefglsv.aattgklvaalrklGfdkVfdtafgadltimeeasellerleeeeklpmitScCPgwvkyvekkypellpnlssvkSPqqilgaliKkylaek.....ekivvVsimPCtaKklEaareefksagrdvDavlTtrElaellkeagidlakleeeeldnplgessgagki...................................egvkeaevelegktlkvavvnGlknikklleklkageakydfiEvmaCpgGCigGg","#MATCH      ++ q+APa+rv+lge fg +v + +t+k++aa + +Gf++Vfdt+++ad+ti ee++e++ r++++  lpm+tScCP+w+++vek +pel+pnls++kSP++++ga +K+y+aek     ++++vVs+mPCtaKk E++r ++ +   dvDav+T+rE+ae++k+ gid+++le +++d ++ges+ga+++                                   +++k+a+++++g +lk+av++G++ +++l+e  +++ ++y+fiEvmaCp GC+gGg","#PP        5789************************************************************9999****************************************************************************98...9***********************************************************************************************************9..778889****************8","#SEQ       VMLFQCAPATRVSLGECFGEEVgTIVTRKIAAAAKIMGFHYVFDTNYAADMTIWEEGTEFIGRVSNNGVLPMFTSCCPAWINFVEKIHPELIPNLSTAKSPHMMMGAALKSYFAEKkkidpKNMFVVSMMPCTAKKDEIKRGQMIE---DVDAVVTVREFAEMIKQFGIDWNSLEGKDFDPVMGESTGAAALfgvtggvmeaavrfahekltndklgkveyyqwrgfKNIKSANIQIGGADLKIAVCSGIAAARELIE--SDEYKNYHFIEVMACPCGCVGGG"],"env":{"to":"473","from":"195"},"name":"Fe_hyd_lg_C","acc":"PF02906.14","sig":1,"evalue":"2.1e-84","desc":"Iron only hydrogenase large subunit, C-terminal domain","hmm":{"to":"243","from":"2"},"act_site":null,"type":"Domain","bits":"283.0","clan":"No_clan","seq":{"to":"473","from":"196","name":"OHT04390.1"}},{"model_length":"56","align":["#HMM       vrkkRakalykiD...kkkklrkSheNpevkklYkeflgeplsekahelLHThYtd","#MATCH      ++kRa+++y+iD   ++++  +S++N e+ ++Yke++gep++ +ahelLHT+Y +","#PP        589***********9777999*********************************87","#SEQ       EITKRADSIYQIDcekRNSTKVTSNDNSEIVQMYKEYMGEPNHGRAHELLHTTYEQ"],"env":{"to":"539","from":"481"},"name":"Fe_hyd_SSU","acc":"PF02256.17","sig":1,"evalue":"2.5e-16","desc":"Iron hydrogenase small subunit","hmm":{"to":"55","from":"3"},"act_site":null,"type":"Domain","bits":"59.5","clan":"No_clan","seq":{"to":"538","from":"483","name":"OHT04390.1"}},{"model_length":"143","align":["#HMM       ilYgSetGnteklAkqlaeelgehgfnadvvslsdydeslseieeealllvvtsTfgnGdppengesffqdllelkgdeledgdlsgvrfavfglGdsayenFcaagkkldekleelGaerllkllegdednqegqeeafrkW","#MATCH     i +gS  Gn+ k+A+++a  +g     +  vsl+ +   l +i ++ ++++v+sTfg+G++p n+++f ++l+++        +l+g+++av++lG+  y++Fc ag+++d++l + Gaerl+   e+d    ++ e  f+ W","#PP        78*******************9.....4799******..77999********************996666666665......48**********************************************9889999999988","#SEQ       IAFGSASGNAAKMARTVASYIG-----TSPVSLNSVG--LTKIIKKGVAVIVCSTFGDGEFPSNAQKFYEQLEANT------EPLNGLKYAVLALGSNDYPKFCLAGRMIDQMLAKQGAERLMDICEIDGSSPDKGEGTFENW"],"env":{"to":"685","from":"556"},"name":"Flavodoxin_1","acc":"PF00258.25","sig":1,"evalue":"3.9e-25","desc":"Flavodoxin","hmm":{"to":"143","from":"1"},"act_site":null,"type":"Domain","bits":"88.7","clan":"CL0042","seq":{"to":"685","from":"556","name":"OHT04390.1"}},{"model_length":"222","align":["#HMM       glkYetGdhlgvypsNneelVeellellgldpkadevvelkaldeesaekeprleptTlrqalkyylditgppskqlleaLaefaseeeekqkLekLssdegakeykelklneartllevleefpsvklplefLlevlpqLkpRyYSiSssskvhpdevhltvvVveyetdgegrirkGvcs","#MATCH     ++kY  Gdh+++ p+N+ ++V++++e l+l+p  ++++e+k+  +e    +  ++ +T++q++ +yld+ g p++ l++a+ +f ++   k++LekL  +  ++ ++++  ++      +le   +  +pl+ L++  p +kpR YSi+s++ ++   ++l+++ +++   g  ++r+G+c+","#PP        89******************************..9******99974..67889999*******************************************96555555555.88888899****************************************99765.3333..44567777777","#SEQ       NMKYLAGDHVAILPQNDVDTVKATIEELKLNP--KDILEVKTELPE--GMNTIPNKVTVEQLFFQYLDLNGIPNRTLIRAFKQFCKNTFAKERLEKLLDPSEPRYLNDFM-KDTSIGEFILEYSRHGIPPLDILISACPLIKPRLYSIASAPTSTSHYIDLIIT-DNIF--GPQNTRHGLCT"],"env":{"to":"933","from":"747"},"name":"FAD_binding_1","acc":"PF00667.20","sig":1,"evalue":"3e-26","desc":"FAD binding domain","hmm":{"to":"220","from":"39"},"act_site":null,"type":"Domain","bits":"92.4","clan":"CL0076","seq":{"to":"931","from":"758","name":"OHT04390.1"}},{"model_length":"109","align":["#HMM       miagGtGiaPvrsvlraileeakdktkvvlvyGnrteedl.lyreeleelakklpgrlkvvavvsreeagweggkgrvqdalleells....lkkeethvyvCGpp","#MATCH     m a G G+aP++s+l+++ e +   ++++l++G+r ++   ++   le++     g+++ ++v   +e ++   k +++d +++++++     +++++ ++ CGp ","#PP        557799**************98899**********999651455556666..4455677777744444554...89**********99999999**********96","#SEQ       MAALGFGVAPMLSLLQHREELDGEIGNAALFFGCRFKNTYpILDSILENY--IDTGAMQDLYVAYSREGTS---KTYITDLMANNTDDvwryWQDPKCEYFYCGPA"],"env":{"to":"1068","from":"963"},"name":"NAD_binding_1","acc":"PF00175.21","sig":1,"evalue":"0.00017","desc":"Oxidoreductase NAD-binding domain ","hmm":{"to":"101","from":"1"},"act_site":null,"type":"Domain","bits":"22.2","clan":"CL0091","seq":{"to":"1063","from":"963","name":"OHT04390.1"}}]'''
# #
# #
# # data = json.loads(data.replace('None','null'))
# # print(json)
from configparser import ConfigParser
from global_var import *

args = args()

def read_config():
    cfg = ConfigParser()
    cfg.read('config.ini')
    if not args.dh:
        args.dh = cfg.getboolean('FASTA parser','keep_duplicate_headers')
    if not args.tax:
        args.tax = cfg.getboolean('FASTA parser','organism_lineage')
    if not args.dbn:
        args.dbn = cfg.getboolean('FASTA parser','protein_name_from_database')
    if not args.dbd:
        args.dbd = cfg.getboolean('FASTA parser','domian_from_database')
    if not args.pfs:
        args.dbd = cfg.getboolean('FASTA parser','pfamscan_search ')
    if not args.pfev:
        args.pfev = cfg.getfloat('FASTA parser','E-value')
        if args.pfev > 1:
            args.pfev = int(args.pfev)
    if not args.pfas:
        args.pfas = cfg['FASTA parser']['active_sites']
    else:
        args.pfas = 'true'
    if not args.email:
        args.email = cfg['FASTA parser']['email']

read_config()
